<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Love Maze - King Edition</title>

<style>
body {
  margin: 0;
  background: #140021;
  overflow: hidden;
  font-family: Arial;
}

canvas {
  display: block;
  margin: auto;
  background: #1b0033;
}

#controls {
  position: fixed;
  bottom: 20px;
  width: 100%;
  text-align: center;
}

button {
  padding: 15px;
  margin: 10px;
  font-size: 18px;
  border-radius: 10px;
  border: none;
  background: hotpink;
  color: white;
}

#loveBtn {
  background: red;
}

#popup {
  position: fixed;
  top: 40%;
  width: 100%;
  text-align: center;
  display: none;
}

#popup button {
  background: deeppink;
  font-size: 22px;
}
</style>
</head>

<body>

<canvas id="game"></canvas>

<div id="controls">
  <button onclick="move('up')">‚¨Ü</button><br>
  <button onclick="move('left')">‚¨Ö</button>
  <button onclick="move('down')">‚¨á</button>
  <button onclick="move('right')">‚û°</button><br>
  <button id="loveBtn" onclick="shootLove()">üíò Love Gun</button>
</div>

<div id="popup">
  <h1 style="color:white;">I Love You ‚ù§Ô∏è</h1>
  <button onclick="goCanva()">Click Here</button>
</div>

<audio id="bgm" loop>
  <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_c8f1b1a3c7.mp3" type="audio/mpeg">
</audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = 350;
canvas.height = 350;

const tile = 12;
const size = 30;

let maze = [];
let hearts = [];
let guards = [];
let score = 0;

let king = {x:0,y:0};
let queen = {x:29,y:29};

function generateMaze(){
  for(let i=0;i<size;i++){
    maze[i]=[];
    for(let j=0;j<size;j++){
      maze[i][j] = Math.random() < 0.35 ? 1 : 0;
    }
  }
  maze[0][0]=0;
  maze[29][29]=0;
}

function generateHearts(){
  for(let i=0;i<15;i++){
    hearts.push({
      x:Math.floor(Math.random()*size),
      y:Math.floor(Math.random()*size)
    });
  }
}

function generateGuards(){
  for(let i=0;i<5;i++){
    guards.push({
      x:Math.floor(Math.random()*size),
      y:Math.floor(Math.random()*size),
      frozen:false
    });
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  for(let i=0;i<size;i++){
    for(let j=0;j<size;j++){
      if(maze[i][j]==1){
        ctx.fillStyle="pink";
        ctx.fillRect(j*tile,i*tile,tile,tile);
      }
    }
  }

  hearts.forEach(h=>{
    ctx.fillStyle="red";
    ctx.beginPath();
    ctx.arc(h.x*tile+6,h.y*tile+6,4,0,Math.PI*2);
    ctx.fill();
  });

  guards.forEach(g=>{
    ctx.fillStyle=g.frozen?"blue":"red";
    ctx.fillRect(g.x*tile,g.y*tile,tile,tile);
  });

  ctx.fillStyle="gold";
  ctx.fillRect(king.x*tile,king.y*tile,tile,tile);

  ctx.fillStyle="white";
  ctx.fillRect(queen.x*tile,queen.y*tile,tile,tile);
}

function move(dir){
  let nx=king.x;
  let ny=king.y;

  if(dir=="up") nx--;
  if(dir=="down") nx++;
  if(dir=="left") ny--;
  if(dir=="right") ny++;

  if(nx>=0 && ny>=0 && nx<size && ny<size && maze[nx][ny]==0){
    king.x=nx;
    king.y=ny;
  }

  checkHeart();
  checkQueen();
  draw();
}

function checkHeart(){
  hearts = hearts.filter(h=>{
    if(h.x==king.y && h.y==king.x){
      score++;
      return false;
    }
    return true;
  });
}

function checkQueen(){
  if(king.x==queen.y && king.y==queen.x){
    document.getElementById("popup").style.display="block";
    fireworks();
  }
}

function shootLove(){
  guards.forEach(g=>{
    if(Math.abs(g.x-king.x)<=1 && Math.abs(g.y-king.y)<=1){
      g.frozen=true;
    }
  });
}

function moveGuards(){
  guards.forEach(g=>{
    if(!g.frozen){
      let dirs=[[1,0],[-1,0],[0,1],[0,-1]];
      let d=dirs[Math.floor(Math.random()*4)];
      let nx=g.x+d[0];
      let ny=g.y+d[1];
      if(nx>=0 && ny>=0 && nx<size && ny<size && maze[nx][ny]==0){
        g.x=nx;
        g.y=ny;
      }
    }
  });
  draw();
}

function fireworks(){
  for(let i=0;i<50;i++){
    ctx.fillStyle="yellow";
    ctx.fillRect(Math.random()*350,Math.random()*350,3,3);
  }
}

function goCanva(){
  window.location.href="https://jaan-special.my.canva.site/";
}

generateMaze();
generateHearts();
generateGuards();
draw();
setInterval(moveGuards,500);
document.getElementById("bgm").play();
</script>

</body>
</html>
