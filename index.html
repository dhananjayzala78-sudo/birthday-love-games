<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;background:#111;overflow:hidden;}
canvas{display:block;margin:auto;background:#ff69b4;}
#joystick{
 position:fixed;bottom:30px;left:30px;
 width:120px;height:120px;
 background:rgba(255,255,255,0.2);
 border-radius:50%;touch-action:none;
}
#stick{
 width:50px;height:50px;
 background:white;border-radius:50%;
 position:absolute;left:35px;top:35px;
}
</style>
</head>
<body>

<canvas id="game" width="420" height="420"></canvas>
<div id="joystick"><div id="stick"></div></div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

const size=21;
const tile=20;

let maze=[];
let king={x:1,y:1};
let queen={x:size-2,y:size-2};

let kingImg=new Image();
let queenImg=new Image();
kingImg.src="king.png";
queenImg.src="queen.png";

function generateMaze(){
 for(let i=0;i<size;i++){
  maze[i]=[];
  for(let j=0;j<size;j++) maze[i][j]=1;
 }
 function carve(x,y){
  let dirs=[[2,0],[-2,0],[0,2],[0,-2]];
  dirs.sort(()=>Math.random()-0.5);
  for(let d of dirs){
   let nx=x+d[0],ny=y+d[1];
   if(nx>0&&ny>0&&nx<size-1&&ny<size-1&&maze[nx][ny]==1){
    maze[nx][ny]=0;
    maze[x+d[0]/2][y+d[1]/2]=0;
    carve(nx,ny);
   }
  }
 }
 maze[1][1]=0;
 carve(1,1);
}

function draw(){
 ctx.clearRect(0,0,420,420);

 for(let i=0;i<size;i++){
  for(let j=0;j<size;j++){
   ctx.fillStyle=maze[i][j]==1?"black":"#ff69b4";
   ctx.fillRect(j*tile,i*tile,tile,tile);
  }
 }

 if(kingImg.complete){
   ctx.drawImage(kingImg,king.y*tile,king.x*tile,tile,tile);
 }else{
   ctx.fillStyle="gold";
   ctx.fillRect(king.y*tile,king.x*tile,tile,tile);
 }

 if(queenImg.complete){
   ctx.drawImage(queenImg,queen.y*tile,queen.x*tile,tile,tile);
 }else{
   ctx.fillStyle="white";
   ctx.fillRect(queen.y*tile,queen.x*tile,tile,tile);
 }
}

function move(dx,dy){
 let nx=king.x+dy;
 let ny=king.y+dx;
 if(maze[nx][ny]==0){
  king.x=nx;
  king.y=ny;
 }
 draw();
}

let joystick=document.getElementById("joystick");
let stick=document.getElementById("stick");

joystick.addEventListener("touchmove",(e)=>{
 let rect=joystick.getBoundingClientRect();
 let t=e.touches[0];
 let x=t.clientX-rect.left-60;
 let y=t.clientY-rect.top-60;
 let dist=Math.sqrt(x*x+y*y);
 if(dist>40){x=x/dist*40;y=y/dist*40;}
 stick.style.left=(60+x-25)+"px";
 stick.style.top=(60+y-25)+"px";

 if(Math.abs(x)>Math.abs(y)){
  move(x>0?1:-1,0);
 }else{
  move(0,y>0?1:-1);
 }
});

joystick.addEventListener("touchend",()=>{
 stick.style.left="35px";
 stick.style.top="35px";
});

generateMaze();
draw();
</script>

</body>
</html>
