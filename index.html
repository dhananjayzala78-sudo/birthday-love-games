<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Love Maze King</title>

<style>
body{
  margin:0;
  background:#140021;
  overflow:hidden;
}

canvas{
  display:block;
  margin:auto;
  background:#1b0033;
}

#controls{
  position:fixed;
  bottom:20px;
  width:100%;
  text-align:center;
}

button{
  padding:15px;
  margin:8px;
  font-size:20px;
  border-radius:12px;
  border:none;
  background:hotpink;
  color:white;
}

#loveBtn{
  background:red;
}

#popup{
  position:fixed;
  top:40%;
  width:100%;
  text-align:center;
  display:none;
}

#popup button{
  font-size:22px;
  background:deeppink;
}
</style>
</head>

<body>

<canvas id="game" width="360" height="360"></canvas>

<div id="controls">
  <button ontouchstart="move('up')">‚¨Ü</button><br>
  <button ontouchstart="move('left')">‚¨Ö</button>
  <button ontouchstart="move('down')">‚¨á</button>
  <button ontouchstart="move('right')">‚û°</button><br>
  <button id="loveBtn" ontouchstart="shootLove()">üíò</button>
</div>

<div id="popup">
  <h1 style="color:white;">I Love You ‚ù§Ô∏è</h1>
  <button onclick="goCanva()">Go To Surprise</button>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

const tile=12;
const size=30;

let maze=[];
let hearts=[];
let guards=[];
let king={x:0,y:0};
let queen={x:29,y:29};

let kingImg=new Image();
kingImg.src="king.png";

let queenImg=new Image();
queenImg.src="queen.png";

function generateMaze(){
  for(let i=0;i<size;i++){
    maze[i]=[];
    for(let j=0;j<size;j++){
      maze[i][j]=(Math.random()<0.3)?1:0;
    }
  }
  maze[0][0]=0;
  maze[29][29]=0;
}

function generateHearts(){
  for(let i=0;i<12;i++){
    hearts.push({
      x:Math.floor(Math.random()*size),
      y:Math.floor(Math.random()*size)
    });
  }
}

function generateGuards(){
  for(let i=0;i<4;i++){
    guards.push({
      x:Math.floor(Math.random()*size),
      y:Math.floor(Math.random()*size),
      frozen:false
    });
  }
}

function draw(){
  ctx.clearRect(0,0,360,360);

  for(let i=0;i<size;i++){
    for(let j=0;j<size;j++){
      if(maze[i][j]==1){
        ctx.fillStyle="pink";
        ctx.fillRect(j*tile,i*tile,tile,tile);
      }
    }
  }

  hearts.forEach(h=>{
    ctx.fillStyle="red";
    ctx.beginPath();
    ctx.arc(h.x*tile+6,h.y*tile+6,4,0,Math.PI*2);
    ctx.fill();
  });

  guards.forEach(g=>{
    ctx.fillStyle=g.frozen?"blue":"red";
    ctx.fillRect(g.y*tile,g.x*tile,tile,tile);
  });

  ctx.drawImage(kingImg,king.y*tile,king.x*tile,tile,tile);
  ctx.drawImage(queenImg,queen.y*tile,queen.x*tile,tile,tile);
}

function move(dir){
  let nx=king.x;
  let ny=king.y;

  if(dir=="up") nx--;
  if(dir=="down") nx++;
  if(dir=="left") ny--;
  if(dir=="right") ny++;

  if(nx>=0 && ny>=0 && nx<size && ny<size && maze[nx][ny]==0){
    king.x=nx;
    king.y=ny;
  }

  checkHeart();
  checkQueen();
  draw();
}

function checkHeart(){
  hearts=hearts.filter(h=>{
    if(h.x==king.y && h.y==king.x){
      return false;
    }
    return true;
  });
}

function checkQueen(){
  if(king.x==queen.y && king.y==queen.x){
    document.getElementById("popup").style.display="block";
  }
}

function shootLove(){
  guards.forEach(g=>{
    if(Math.abs(g.x-king.x)<=1 && Math.abs(g.y-king.y)<=1){
      g.frozen=true;
      setTimeout(()=>{g.frozen=false;},2000);
    }
  });
}

function moveGuards(){
  guards.forEach(g=>{
    if(!g.frozen){
      let dirs=[[1,0],[-1,0],[0,1],[0,-1]];
      let d=dirs[Math.floor(Math.random()*4)];
      let nx=g.x+d[0];
      let ny=g.y+d[1];
      if(nx>=0 && ny>=0 && nx<size && ny<size && maze[nx][ny]==0){
        g.x=nx;
        g.y=ny;
      }
    }
  });
  draw();
}

function goCanva(){
  window.location.href="https://jaan-special.my.canva.site/";
}

generateMaze();
generateHearts();
generateGuards();
setInterval(moveGuards,600);
draw();
</script>

</body>
</html>
