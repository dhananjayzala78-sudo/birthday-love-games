<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Love Maze Ultimate</title>
<style>
body{margin:0;background:#111;overflow:hidden;}
canvas{display:block;margin:auto;background:#ff69b4;}
#joystick{
 position:fixed;
 bottom:30px;
 left:30px;
 width:120px;
 height:120px;
 background:rgba(255,255,255,0.15);
 border-radius:50%;
 touch-action:none;
}
#stick{
 width:50px;
 height:50px;
 background:white;
 border-radius:50%;
 position:absolute;
 left:35px;
 top:35px;
}
#loveBtn{
 position:fixed;
 bottom:50px;
 right:40px;
 padding:20px;
 font-size:22px;
 background:red;
 color:white;
 border:none;
 border-radius:50%;
}
</style>
</head>
<body>

<canvas id="game" width="420" height="420"></canvas>

<div id="joystick"><div id="stick"></div></div>
<button id="loveBtn">ðŸ’˜</button>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

const size=21;
const tile=20;

let maze=[];
let king={x:1,y:1};
let queen={x:size-2,y:size-2};
let monsters=[];

let kingImg=new Image();
let queenImg=new Image();
kingImg.src="king.png";
queenImg.src="queen.png";

function generateMaze(){
 for(let i=0;i<size;i++){
  maze[i]=[];
  for(let j=0;j<size;j++) maze[i][j]=1;
 }
 function carve(x,y){
  let dirs=[[2,0],[-2,0],[0,2],[0,-2]];
  dirs.sort(()=>Math.random()-0.5);
  for(let d of dirs){
   let nx=x+d[0], ny=y+d[1];
   if(nx>0&&ny>0&&nx<size-1&&ny<size-1&&maze[nx][ny]==1){
    maze[nx][ny]=0;
    maze[x+d[0]/2][y+d[1]/2]=0;
    carve(nx,ny);
   }
  }
 }
 maze[1][1]=0;
 carve(1,1);
}

function spawnMonsters(){
 monsters=[
  {x:5,y:5,type:"ðŸ¥·",frozen:false},
  {x:9,y:9,type:"ðŸ§™",frozen:false},
  {x:13,y:13,type:"ðŸ§›",frozen:false}
 ];
}

function draw(){
 ctx.clearRect(0,0,canvas.width,canvas.height);
 for(let i=0;i<size;i++){
  for(let j=0;j<size;j++){
   ctx.fillStyle = maze[i][j]==1 ? "black" : "#ff69b4";
   ctx.fillRect(j*tile,i*tile,tile,tile);
  }
 }
 monsters.forEach(m=>{
  ctx.font="18px Arial";
  ctx.fillText(m.type,m.y*tile+2,m.x*tile+18);
 });
 ctx.drawImage(kingImg,king.y*tile,king.x*tile,tile,tile);
 ctx.drawImage(queenImg,queen.y*tile,queen.x*tile,tile,tile);
}

function move(dx,dy){
 let nx=king.x+dx;
 let ny=king.y+dy;
 if(maze[nx][ny]==0){
  king.x=nx;
  king.y=ny;
 }
 if(king.x==queen.x && king.y==queen.y){
  alert("I Love You â¤ï¸");
  window.location.href="https://jaan-special.my.canva.site/";
 }
 draw();
}

function moveMonsters(){
 monsters.forEach(m=>{
  if(!m.frozen){
   let dirs=[[1,0],[-1,0],[0,1],[0,-1]];
   let d=dirs[Math.floor(Math.random()*4)];
   let nx=m.x+d[0], ny=m.y+d[1];
   if(maze[nx][ny]==0){m.x=nx;m.y=ny;}
  }
 });
 draw();
}

document.getElementById("loveBtn").ontouchstart=()=>{
 monsters.forEach(m=>{
  if(Math.abs(m.x-king.x)<=1 && Math.abs(m.y-king.y)<=1){
   m.frozen=true;
   setTimeout(()=>m.frozen=false,2000);
  }
 });
};

let joystick=document.getElementById("joystick");
let stick=document.getElementById("stick");

joystick.addEventListener("touchmove",(e)=>{
 let rect=joystick.getBoundingClientRect();
 let touch=e.touches[0];
 let x=touch.clientX-rect.left-60;
 let y=touch.clientY-rect.top-60;
 let dist=Math.sqrt(x*x+y*y);
 if(dist>40){
  x=x/dist*40;
  y=y/dist*40;
 }
 stick.style.left=(60+x-25)+"px";
 stick.style.top=(60+y-25)+"px";

 if(Math.abs(x)>Math.abs(y)){
  move(0,x>0?1:-1);
 }else{
  move(y>0?1:-1,0);
 }
});

joystick.addEventListener("touchend",()=>{
 stick.style.left="35px";
 stick.style.top="35px";
});

kingImg.onload=()=>{
 queenImg.onload=()=>{
  generateMaze();
  spawnMonsters();
  setInterval(moveMonsters,700);
  draw();
 }
}
</script>
</body>
</html>
